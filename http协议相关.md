# [硬核！30 张图解 HTTP 常见的面试题](https://mp.weixin.qq.com/s/bUy220-ect00N4gnO0697A)

文章结构：

1. HTTP 基本概念
2. Get和Post
3. HTTP特性
4. HTTPS与HTTP
5. HTTP/1.1、HTTP/2、HTTP/3的演变

## HTTP基本概念

### HTTP 是什么？描述一下？

HTTP 是 超文本传输协议， 也就是 HyperText Transfer Protocol

详细解释一下 超文本传输协议

可以拆成三个部分

超文本-> 传输 -> 协议

HTTP是一个用在计算机世界里的协议。它使用计算机能够理解的语言确立了一种计算机之间交流通信的规范（两个以上的参与者），以及相关的各种控制和错误处理方式（行为约定和规范）

HTTP是一个双向协议

我们在上网冲浪时，浏览器是请求方A，百度网站就是应答方B。双方约定用HTTP协议来通信，于是浏览器把请求数据发送给网站，网站再把一些数据返回给浏览器，最后由浏览器渲染在屏幕，就可以看到图片、视频了。

数据虽然是在A和B之间传输，但允许中间有中转或接力。

### HTTP 常见的状态码有哪些？

| 状态码 | 具体含义                                               | 常见状态码         |
| :----: | :----------------------------------------------------- | ------------------ |
|  1xx   | 提示信息, 表示目前是协议处理的中间状态, 还需要后续操作 |                    |
|  2xx   | 成功, 报文已经收到并被正确处理                         | 200、204、206      |
|  3xx   | 重定向, 资源位置发生变动, 需要客户端重新发送请求       | 301、302、304      |
|  4xx   | 客户端错误, 请求报文有误, 服务器无法处理               | 400、403、404      |
|  5xx   | 服务器错误, 服务器在处理请求时内部发生了错误           | 500、501、502、503 |

#### 1xx

`1xx` 类状态码属于提示信息, 是协议处理中的一种中间状态, 实际用到的比较少.

#### 2xx

`2xx`类状态码表示服务器成功处理了客户端的请求, 也是我们最愿意看到的状态.

「200 OK」是最常见的成功状态码, 表示一切正常. 如果是非 HEAD 请求, 服务器返回的响应头都会有 body 数据.

「204 No Content」也是常见的成功状态码, 与200 OK 基本相同, 但响应头没有 body 数据.

「206 Partial Content」是应用于 HTTP 分块下载或断电续传, 表示响应返回的body 数据并不是资源的全部, 而是其中的一部分, 也是服务器处理成功的状态.

#### 3xx

`3xx` 类状态码表示客户端请求的资源发生了变动, 需要客户端用新的URL 重新发送请求获取资源, 也就是**重定向**

「**301 Moved Permanently**」表示永久重定向, 说明请求的资源已经不存在了, 需该用新的URL再次访问.

「**302 Moved Temporarily**」表示临时重定向, 说明请求的资源还在, 但暂时需要用另一个URL来访问.

301和302 都会在响应头里使用字段 Location, 指明后续要跳转的URL, 浏览器会自动重定向新的URL.

「**304 Not Modified**」不具有跳转的含义, 表示资源未修改, 重定向已存在的缓冲文件, 也称缓存重定向, 用于缓存控制.

#### 4xx

`4xx` 类状态码表示客户端发送的报文有误, 服务器无法处理, 也就是错误码的含义.

「**400 Bad Request**」表示客户端请求的报文有错误, 但只是个笼统的错误.

「**403 Forbidden**」表示服务器禁止访问资源, 并不是客户端的请求出错.

「**404 Not Found**」表示请求的资源在服务器上不存在或未找到, 所以无法提供给客户端.

#### 5xx

`5xx` 类状态码表示客户端请求报文正确, 但是**服务器处理时内部发生了错误**, 属于服务器端的错误码.

「**500 Internal Server Error**」与 400 类型, 是个笼统的错误码, 服务器发生了什么错误, 我们并不知道.

「**501 Not Implemented**」表示客户端请求的功能还不支持, 类似“即将开业, 敬请期待”的意思.

「**502 Bad Gateway**」通常是服务器作为网关或代理时返回的错误码, 表示服务器自身工作正常, 访问后段服务器发生了错误.

「**503 Service Unavailable**」表示服务器当前很忙, 暂时无法响应服务器, 类似“网络服务正忙, 请稍后重试”的意思.

### http 常见字段有哪些?

#### Host

客户端发送请求时, 用来指定服务器的域名.

```html
Host: www.A.com
```

有了 Host 字段, 就可以将请求发往「同一台」服务器上的不同网站.

#### Content-Length

服务器在返回数据时, 会有 Content-Length 字段, 表明本次回应的数据长度.

```html
Content-Length: 1000
```

如上面则是告诉浏览器, 本次服务器回应的数据长度是1000个字节, 后面的字节就属于下一个回应了

#### Connection

Connection 字段最常用于客户端要求服务器使用 TCP 永久连接, 以便其他请求复用.

HTTP/1.1 版本的默认连接都是持久连接, 但为了兼容老版本的HTTP, 需要指定 Connection 首部字段的值为 keep-alive.

```html
Connection: keep-alive
```

一个可以复用的TCP连接就建立了, 直到客户端或服务器主动关闭连接. 但是, 这不是标准字段.

#### Content-Type

Content-Type 字段用户服务器回应时, 告诉客户端, 本次数据是什么格式.

```html
Content-Type: text/html; charset=utf-8
```

上面的类型表明, 发送的是网页, 而且编码是UTF-8

客户端请求的时候, 可以使用 Accept 字段声明自己可以接受哪些数据格式.

```html
Accpt: */*
```

上面代码中, 客户端声明自己可以接受任何格式的数据

#### Content-Encoding

Content-Encoding 字段说明数据的压缩方法. 表示服务器返回的数据使用了什么压缩格式.

```html
Content-Encoding: gzip
```

上面表示服务器返回的数据采用了gzip 方式压缩, 告知客户端需要用此方式解压.

客户端在请求时, 用 `Accept-Encoding`字段说明自己可以接受哪些压缩方法.

```html
Accept-Encoding: gzip, deflate
```

## GET 与 POST

### 说一下 GET 和 POST 的区别？



### GET 和 POST 方法都是安全和幂等的吗？



## HTTP 特性

### 你知道的 HTTP(1.1) 的优点有哪些，怎么体现的？



### 那它的缺点呢？



### 那你说下 HTTP/1.1 的性能如何？



## HTTP 与 HTTPS

### HTTP 与 HTTPS 有哪些区别？



### HTTPS 解决了 HTTP 的哪些问题？



### HTTPS 是如何解决上面的三个风险的？



### HTTPS是如何建立连接的？其间交互了什么？



## HTTP/1.1、HTTP/2、HTTP/3 演变

### 说说 HTTP/1.1 相比 HTTP/1.0 提高了什么性能？



### 那上面的 HTTP/1.1 的性能瓶颈，HTTP/2 做了什么优化？



### HTTP/2 有哪些缺陷？HTTP/3 做了哪些优化？



# [探究！一个数据包在网络中的心路历程](https://mp.weixin.qq.com/s/iSZp41SRmh5b2bXIvzemIw)

## 孤单小弟 —— HTTP

### 浏览器做的第一步工作是解析 URL



### 要是上图中的蓝色部分 URL 元素都省略了，哪应该是请求哪个文件呢？



### 生产 HTTP 请求信息



## 真实地址查询 —— DNS

### 域名的层级关系



### 域名解析的工作流程



## 指南好帮手 —— 协议栈



## 可靠传输 —— TCP

### TCP 传输数据之前，要先三次握手建立连接



### 如何查看 TCP 的连接状态？



### TCP 分割数据



### TCP 报文生成



## 远程定位 —— IP

### IP 包头格式



### 假设客户端有多个网卡，就会有多个 IP 地址，那 IP 头部的源地址应该选择哪个 IP 呢?



### IP 报文生成



## 两点传输 —— MAC

### MAC 包头格式



### MAC 发送方和接收方如何确认?



### 既然知道要发给谁，按如何获取对方的 MAC 地址呢？



### 好像每次都要广播获取，这不是很麻烦吗？



### 查看 ARP 缓存内容



### MAC 报文生成



## 出口 —— 网卡



## 送别者 —— 交换机

### 交换机的包接收操作



### 当 MAC 地址表找不到指定的 MAC 地址会怎么样？



## 出境大门 —— 路由器

### 路由器基本原理



### 路由器的包接收操作



### 查询路由表确定输出端口



### 路由器的发送操作



## 互相扒皮 —— 服务器 与 客户端

### 一个数据包臭不要脸的感受



HTTP 协议