## [基础网络概念](http://linux.vbird.org/linux_server/0110network_basic.php#whatisnetwork_comps)

### 2.1 网络是个什么玩意

这个标准是由国际组织规范的，你的系统里面只要提供符合该标准的程序代码，那你就能够通过这个标准和其他系统进行沟通。

#### 2.1.1 什么是网络



除了硬件之外，TCP/IP这个Internet的通讯协议也是有标准的，这些标准大部分都以RFC（Request For Comments）的形式发布标准文件。通过这些文件的辅助，任何人只要会写程序的话，就有可能发展出自己的TCP/IP软件，并且连接上Internet。早期的linux为了要连上Internet，Linux团队就自己编写出TCP/IP的代码，通过这些基础文件的标准依据。举例来说RFC 1122这个建议文件就指出一些可以连线到Internet的主机应该要注意的相关协议与基本要求，让想要编写连线程序的设计师可以有一个指引的标准方向。

集线器（hub）不是节点，因为它不具有IP。

网关：具有两个以上的网卡界面，可以连接两个以上不同的网段的设备，例如IP分享器就是一个常见的网关设备。那上面的ADSL数据机算不算网关呢？其实不太能算，因为数据机通常视为一个在主机内的网卡设备，我们可以在一般PC上面通过拨号软件，将数据机模拟成为一张实体网卡（ppp），因此不太能算网关设备。

#### 2.1.4 电脑网络通讯协议： OSI七层协议

其中比较特殊的是第二层，因为第二层（数据链路层）主要是位于软件封包以及硬件frame中间的一个阶层，它必须要将软件包装的包裹放入到硬件能够处理的包裹中，因此这个阶层又分为两个子层在处理相对应的资料。因为比较特殊，所以第二层的数据格式尾部还会出现一个检查码。

每一层负责的任务：

|     分层      |                           负责内容                           |
| :-----------: | :----------------------------------------------------------: |
| 第一层 实体层 | 由于网络媒体只能传送0和1这样的内容，因此实体层必须定义所使用的的媒体设备的电压和信号等，同时还必须了解数据帧转换成0/1的编码方式，最后连接实体媒体并传送/接收0/1 |
|  数据链路层   | 这一层是比较特殊的一个阶层，因为底下是实体的定义，而上层是软件封装的定义。因为第二层又分两个子层在进行数据的转换动作。在偏硬件的部分，主要负责的是MAC（Media Access Control），我们称这个数据包为MAC帧，MAC是网络媒体所能处理的主要数据包，这也是最终被实体层编码成01的数据。MAC必须经由通讯协议来取得媒体的使用权。目前最常使用的是IEEE 802.3的以太网协议。  至于偏软件的部分则是由逻辑链路层（logical link control, LLC）所控制，主要在多任务处理来自上层的数据包资料并转成MAC的格式，负责的工作包括信息交换，流量控制，失误问题的处理等等。 |
|    网络层     | 这一层是我们最感兴趣的，因为我们提及的IP就是在这一层定义的。同时也定义出电脑之间的连线建立、终止与维持等等，数据包的传输路径选择等等，因此这个层级当中最重要的除了IP之外，就是数据包等否到达目的地的路由概念了。 |
|    传输层     | 这一层定义了发送端和接收端的连接技术（如TCP，UDP），同时包括该技术的数据包格式，数据包的传送，流量控制，传输过程的检测检查和失败重传等等，以确保各个数据包可以正确无误的到达目的端 |
|    会话层     | 在这个层级中主要定义了两个地址之间的连线通道之连接和挂断，此外，也可建立应用程序的对话、提供其他加强型服务如网络管理，签到签退，对话控制等等。如果说传输层是在判断数据包是否可以正确的到达目标，那么会话层则是在确定网路服务建立连接的确认。 |
|    表现层     | 我们在应用程序上所制作出来的数据格式不一定符合网络传输的标准编码格式，所以在这个层级当中，主要的动作就是：将来自本地端应用程序的数据格式转换（或者是重新编码）称为网络的标准格式，然后再交给底下的传输层等协议来进行处理。所以在这个层级上主要定义的是网络服务（或程序）之间的数据格式的转换，包括数据的加密解密也是在这个层面上处理 |
|    应用层     | 应用层本身并不属于应用程序所有，而是在定义应用程序如何进入此层的沟通界面，以将数据接收或传送给应用程序，最终展示给使用者。 |

#### 2.1.5 电脑网络通讯协议： TCP/IP

应用层：

传输层：依据传送的可靠性又将数据包格式分为连接导向的TCP以及非连接导向的UDP数据包格式。

网络层：也没有改变，主要内容是提供了IP数据包，并可选择最佳路由来到达目标IP位置。

数据链路层和实体层整合为一个链路层，包括定义硬件信息，编码等，因此主要与硬件有关。

链路层：如果使用以太网络时，此时IP会依据CSMA/CD的标准，包裹到MAC数据帧中，并给予MAC表头，

网络媒体一次传输的数据量是有限的，因此如果要被传输的数据太大时，我们在分层的包装中，就得要将数据先拆开放到不同的包裹中，再给包裹一个序号，好让目的端的主机能够藉由这些序号再重新将数据整合回来。

> 一般来说，因为应用程序和开发工程师比较有关系，而网络层以下的数据则主要是由操作系统提供的，因此，我们又将TCP/IP当中的应用层视为使用者层，而底下的三层才是我们主要谈到的网络基础。

### 2.2 TCP/IP的链路层相关协议

TCP/IP最底层的链路层主要和硬件比较有关系，因此底下我们主要介绍一些WAN 和LAN 的硬件。同时会介绍CSMA/CD 的以太网络协议，以及相关的硬件与MAC数据帧等

#### 2.2.1 广域网使用的设备

#### 2.2.2 局域网使用的设备-以太网络

ADSL传输速度可以达到下行2Mbps/128Kbps(Kbits per second)，这里的Kb指的不是bytes而是bits。所以2M/128K 在实际的文件大小传输速度上，最大理论传输为256KBps/16KBps(KBytes per second), 所以正常下载的速度约在每秒100~200KBytes 之间。所以一般bps还要除以8才是Bps,

跳线：一边为568A 一边为568B的接头时称为跳线，用在直接连接两部主机的网卡。

平行线：两边接头同为568A或568B时称为平行线，用在连接主机网卡与集线器之间的线材。

#### 2.2.3 以太网络的传输协议： CSMA/CD

以太网络的传输主要就是网卡对网卡之间的数据传输。每张以太网卡出厂时，就会赋予一个独一无二的卡号，就是所谓的MAC（Media Access Control）.以太网络的网卡之间数据是通过CSMA/CD来传输的。

中心点为集线器，各个主机都是连线到集线器，然后通过集线器的功能向所有主机发起连线的。

网络共享媒体在单一时间点内，仅能被一部主机所使用。

1. 监听媒体使用情况：A主机要发送网络包前，先要对网络媒体进行监听，确认没人在用之后，才能发送出数据帧。
2. 多点传输： A主机所送出的数据会被集线器复制一份，然后传送给所有连接到此集线器的主机。
3. 碰撞检测：

既然共享媒体只有一个主机可以使用，为何大家可以同时上网？

这个集线器的使用权是大家抢着用的。

#### 2.2.4 MAC的封装格式

数据帧上面有两个很重要的数据，就是目标和来源的网卡卡号，

只要通过B（就是路由器）才将数据包送到另一个网段去的时候，数据帧内的网卡编号就会被改变。

数据帧内的数据内容最小要46Kbytes，因为要检测碰撞，数据帧数据总量要有64Bytes，再去掉目的地址，来源地址，校验码后，就可以得到数据量最小要有46Bytes，也就是说，如果你要传输的数据小于46Bytes，系统会主动填上一些填充码，以补全至少46Bytes的容量。

#### 2.2.5 MTU 最大传输单位

标准以太网络数据帧所能传送的数量量最大可达1500bytes，这个数值就被我们称为MTU（Maximum Transmission Unit，最大传输单位）



























### 2.3 TCP/IP的网络层相关数据包与资料

### 2.4 TCP/IP 传输层相关数据包与资料

### 2.5 连上 Internet前的准备事项